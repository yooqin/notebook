# 20180521

- ssh-copy-id

  **安装ssh-copy-id	curl -L https://raw.githubusercontent.com/beautifulcode/ssh-copy-id-for-OSX/master/install.sh | sh生成公私钥	ssh-keygen增加sshconfigvim ~/.ssh/config增加如下内容：Host udev    		Hostname 119.254.115.172    		Port 65522    		User $name(姓名全拼)将公钥复制到开发机做授信ssh-copy-id -i ~/.ssh/id_rsa.pub $name@udev** 

  https://www.ssh.com/ssh/copy-id
- .ssh下config问题，设置host及主机名方式
- ssh (.ssh ssh -vvv)  ssh调试、免密码登录、用户管理

- 进程 线程 并行 并发
- 管道



# 20180522

Todo:
- 理清代码入口(PC站M站)
- 理清Model&selector
- 适当记录并补充到新手文档
- 理清页面请求参数的作用
- 尝试修改一点东西
- 开发技术栈
	PHP 7.0, yaf framework
	Nginx
	MySQL,redis
	Memcached,Garman/Swoole,RabbitMQ
	Elasticsearch
- 代码结构

# 20180523

- 完成session部分跟进
$enroll = f('enroll')->get_enroll_info($group_id);
/*
array (size=15)
  'enrollId' => string '2555' (length=4)
  'status' => string '1' (length=1)
  'title' => string '测试积分是登录解决-yq3' (length=31)
  'autoCheck' => string '1' (length=1)
  'desc' => string '' (length=0)
  'shareUrl' => string 'http://m.qinwei.umucdn.cn/sse_Fdf3f3' (length=36)
  'shareQrc' => string 'http://qinwei.umucdn.cn/qrc/?type=enroll&param=2555&opc=web' (length=59)
  'inUse' => string '' (length=0)
  'payment' => 
    array (size=2)
      'switch_status' => string '0' (length=1)
      'amount' => string '0' (length=1)
  'contactInfo' => 
    array (size=14)
      0 => 
        array (size=11)
          'questionTitle' => string '姓名' (length=6)
          'questionDefaultValue' => 
            array (size=1)
              ...
          'defaultPlaceHolder' => string '输入真实姓名' (length=18)
          'placeHolder' => string '' (length=0)
          'questionValue' => string '' (length=0)
          'domType' => string 'text' (length=4)
          'key' => string 'username' (length=8)
          'isRequired' => string '1' (length=1)
          'isSelected' => string '0' (length=1)
          'canMove' => string '1' (length=1)
          'isMustKey' => string '0' (length=1)
      1 => 
        array (size=11)
          'questionTitle' => string '手机' (length=6)
          'questionDefaultValue' => 
            array (size=1)
              ...
          'defaultPlaceHolder' => string '输入手机号码' (length=18)
          'placeHolder' => string '' (length=0)
          'questionValue' => string '' (length=0)
          'domType' => string 'text' (length=4)
          'key' => string 'mobile' (length=6)
          'isRequired' => string '1' (length=1)
          'isSelected' => string '0' (length=1)
          'canMove' => string '1' (length=1)
          'isMustKey' => string '0' (length=1)
      2 => 
        array (size=11)
          'questionTitle' => string '公司' (length=6)
          'questionDefaultValue' => 
            array (size=1)
              ...
          'defaultPlaceHolder' => string '您的公司' (length=12)
          'placeHolder' => string '' (length=0)
          'questionValue' => string '' (length=0)
          'domType' => string 'text' (length=4)
          'key' => string 'company' (length=7)
          'isRequired' => string '1' (length=1)
          'isSelected' => string '0' (length=1)
          'canMove' => string '1' (length=1)
          'isMustKey' => string '0' (length=1)
      3 => 
        array (size=11)
          'questionTitle' => string '部门' (length=6)
          'questionDefaultValue' => 
            array (size=1)
              ...
          'defaultPlaceHolder' => string '您的部门' (length=12)
          'placeHolder' => string '' (length=0)
          'questionValue' => string '' (length=0)
          'domType' => string 'text' (length=4)
          'key' => string 'department' (length=10)
          'isRequired' => string '1' (length=1)
          'isSelected' => string '0' (length=1)
          'canMove' => string '1' (length=1)
          'isMustKey' => string '0' (length=1)
      4 => 
        array (size=11)
          'questionTitle' => string '职位' (length=6)
          'questionDefaultValue' => 
            array (size=1)
              ...
          'defaultPlaceHolder' => string '您的职位' (length=12)
          'placeHolder' => string '' (length=0)
          'questionValue' => string '' (length=0)
          'domType' => string 'text' (length=4)
          'key' => string 'position' (length=8)
          'isRequired' => string '1' (length=1)
          'isSelected' => string '0' (length=1)
          'canMove' => string '1' (length=1)
          'isMustKey' => string '0' (length=1)
      5 => 
        array (size=11)
          'questionTitle' => string '工号' (length=6)
          'questionDefaultValue' => 
            array (size=1)
              ...
          'defaultPlaceHolder' => string '您的工号' (length=12)
          'placeHolder' => string '' (length=0)
          'questionValue' => string '' (length=0)
          'domType' => string 'text' (length=4)
          'key' => string 'job_number' (length=10)
          'isRequired' => string '1' (length=1)
          'isSelected' => string '0' (length=1)
          'canMove' => string '1' (length=1)
          'isMustKey' => string '0' (length=1)
      6 => 
        array (size=11)
          'questionTitle' => string '城市' (length=6)
          'questionDefaultValue' => 
            array (size=1)
              ...
          'defaultPlaceHolder' => string '您所在的城市' (length=18)
          'placeHolder' => string '' (length=0)
          'questionValue' => string '' (length=0)
          'domType' => string 'text' (length=4)
          'key' => string 'city' (length=4)
          'isRequired' => string '1' (length=1)
          'isSelected' => string '0' (length=1)
          'canMove' => string '1' (length=1)
          'isMustKey' => string '0' (length=1)
      7 => 
        array (size=11)
          'questionTitle' => string '地址' (length=6)
          'questionDefaultValue' => 
            array (size=1)
              ...
          'defaultPlaceHolder' => string '请输入您的地址' (length=21)
          'placeHolder' => string '' (length=0)
          'questionValue' => string '' (length=0)
          'domType' => string 'text' (length=4)
          'key' => string 'address' (length=7)
          'isRequired' => string '1' (length=1)
          'isSelected' => string '0' (length=1)
          'canMove' => string '1' (length=1)
          'isMustKey' => string '0' (length=1)
      8 => 
        array (size=11)
          'questionTitle' => string '性别' (length=6)
          'questionDefaultValue' => 
            array (size=2)
              ...
          'defaultPlaceHolder' => string '' (length=0)
          'placeHolder' => string '' (length=0)
          'questionValue' => string '' (length=0)
          'domType' => string 'radio' (length=5)
          'key' => string 'sex' (length=3)
          'isRequired' => string '1' (length=1)
          'isSelected' => string '0' (length=1)
          'canMove' => string '1' (length=1)
          'isMustKey' => string '0' (length=1)
      9 => 
        array (size=11)
          'questionTitle' => string '邮箱' (length=6)
          'questionDefaultValue' => 
            array (size=1)
              ...
          'defaultPlaceHolder' => string '请输入您的邮箱' (length=21)
          'placeHolder' => string '' (length=0)
          'questionValue' => string '' (length=0)
          'domType' => string 'text' (length=4)
          'key' => string 'email' (length=5)
          'isRequired' => string '1' (length=1)
          'isSelected' => string '0' (length=1)
          'canMove' => string '1' (length=1)
          'isMustKey' => string '0' (length=1)
      10 => 
        array (size=11)
          'questionTitle' => string '电话' (length=6)
          'questionDefaultValue' => 
            array (size=1)
              ...
          'defaultPlaceHolder' => string '请输入您的电话' (length=21)
          'placeHolder' => string '' (length=0)
          'questionValue' => string '' (length=0)
          'domType' => string 'text' (length=4)
          'key' => string 'phone' (length=5)
          'isRequired' => string '1' (length=1)
          'isSelected' => string '0' (length=1)
          'canMove' => string '1' (length=1)
          'isMustKey' => string '0' (length=1)
      11 => 
        array (size=11)
          'questionTitle' => string 'QQ' (length=2)
          'questionDefaultValue' => 
            array (size=1)
              ...
          'defaultPlaceHolder' => string '请输入您的QQ' (length=17)
          'placeHolder' => string '' (length=0)
          'questionValue' => string '' (length=0)
          'domType' => string 'text' (length=4)
          'key' => string 'qq' (length=2)
          'isRequired' => string '1' (length=1)
          'isSelected' => string '0' (length=1)
          'canMove' => string '1' (length=1)
          'isMustKey' => string '0' (length=1)
      12 => 
        array (size=11)
          'questionTitle' => string '微信' (length=6)
          'questionDefaultValue' => 
            array (size=1)
              ...
          'defaultPlaceHolder' => string '请输入您的微信' (length=21)
          'placeHolder' => string '' (length=0)
          'questionValue' => string '' (length=0)
          'domType' => string 'text' (length=4)
          'key' => string 'weixin' (length=6)
          'isRequired' => string '1' (length=1)
          'isSelected' => string '0' (length=1)
          'canMove' => string '1' (length=1)
          'isMustKey' => string '0' (length=1)
      13 => 
        array (size=11)
          'questionTitle' => string '备注' (length=6)
          'questionDefaultValue' => 
            array (size=1)
              ...
          'defaultPlaceHolder' => string '请输入备注' (length=15)
          'placeHolder' => string '' (length=0)
          'questionValue' => string '' (length=0)
          'domType' => string 'text' (length=4)
          'key' => string 'remark' (length=6)
          'isRequired' => string '1' (length=1)
          'isSelected' => string '0' (length=1)
          'canMove' => string '1' (length=1)
          'isMustKey' => string '0' (length=1)
  'questionArr' => 
    array (size=0)
      empty
  'sectionArr' => 
    array (size=0)
      empty
  'setupInfo' => 
    array (size=2)
      'share' => 
        array (size=5)
          'shareStatus' => int 1
          'shareStart' => string '' (length=0)
          'shareEnd' => string '' (length=0)
          'wxShareTitle' => string '' (length=0)
          'wxShareDesc' => string '' (length=0)
      'payment' => 
        array (size=2)
          'switch_status' => string '0' (length=1)
          'amount' => string '0' (length=1)
  'totalAmount' => string '0' (length=1)
  'multimedia_type' => int 0
*/

is_enrolled = f('enroll')->is_enrolled_by_student_id($role_id, $student_id, true);



//需要报名时验证用户是否报名
            $enroll = f('enroll')->get_enroll_info($group_id);
            if ($enroll && $enroll['enrollId']) {

                $is_enrolled = f('enroll')->is_enrolled_by_student_id($enroll['enrollId'], $student_id, true);
                if (!$is_enrolled) {
                    throw new \Exception('user not enrolled!');
                }
            }






bao



cookie:
JSESSID=oqjl0v3a2anlss12fjgcl1ll61; app_ul=zh-cn; estuid=u118356615; estuidtoken=9614f1ba06a45524871731e9180a89881527068747; umuU=b176d6f7e20c332c88c167319e502ca2


报名:
post   m.qinwei.umucdn.cn/ajax/verify/auto 

get m.qinwei.umucdn.cn/sse_Fdf3f3
get m.qinwei.umucdn.cn/model/sse_Fdf3f3
get m.qinwei.umucdn.cn/model/sse_Fdf3f3



http://api.qinwei.umucdn.cn/session/savesession  
parent_question_id = 362982

session_data
{"sectionArr":[{"answerArr":[],"questionInfo":{"questionId":"","questionTitle":"qinwei的作业","extend":{},"required":"1","domType":"weike","sessionId":""}}],"sessionInfo":{"is_require":"1","sessionInUse":false,"sessionType":7,"autoCheck":true,"resultType":"","setup":{},"tags":[],"teacherId":"15418","sessionTitle":"qinwei的作业","desc":"Ssssd","sessionIndex":1,"access_permission":1,"studentRegFlag":false,"sessionId":"","sessionStatus":false,"groupId":"0"}}

submit_status=0




- 提交作业接口
curl -d "parent_question_id=362982&submit_status=0&session_data={"sectionArr":[{"answerArr":[],"questionInfo":{"questionId":"","questionTitle":"qinwei的作业","extend":{},"required":"1","domType":"weike","sessionId":""}}],"sessionInfo":{"is_require":"1","sessionInUse":false,"sessionType":7,"autoCheck":true,"resultType":"","setup":{},"tags":[],"teacherId":"15418","sessionTitle":"qinwei的作业","desc":"Ssssd","sessionIndex":1,"access_permission":1,"studentRegFlag":false,"sessionId":"","sessionStatus":false,"groupId":"0"}}" -b "JSESSID=oqjl0v3a2anlss12fjgcl1ll61; app_ul=zh-cn; estuid=u118356615; estuidtoken=9614f1ba06a45524871731e9180a89881527068747; umuU=b176d6f7e20c332c88c167319e502ca2" http://api.qinwei.umucdn.cn/session/savesession


curl -d "parent_question_id=363001&submit_status=0&session_data={"sectionArr":[{"answerArr":[],"questionInfo":{"questionId":"","questionTitle":"qinwei的作业","extend":{},"required":"1","domType":"weike","sessionId":""}}],"sessionInfo":{"is_require":"1","sessionInUse":false,"sessionType":7,"autoCheck":true,"resultType":"","setup":{},"tags":[],"teacherId":"15418","sessionTitle":"qinwei的作业","desc":"Ssssd","sessionIndex":1,"access_permission":1,"studentRegFlag":false,"sessionId":"","sessionStatus":false,"groupId":"0"}}" -b "JSESSID=oqjl0v3a2anlss12fjgcl1ll61; app_ul=zh-cn; estuid=u118356615; estuidtoken=9614f1ba06a45524871731e9180a89881527068747; umuU=b176d6f7e20c332c88c167319e502ca2" http://api.qinwei.umucdn.cn/session/savesession




http://m.qinwei.umucdn.cn/model/ssu_MVEe895


http://api.qinwei.umucdn.cn/qr/fetchqrcode
http://m.qinwei.umucdn.cn/session/homework?surl=MVEe895


http://api.qinwei.umucdn.cn/group/publishNotificationGit



- 修改未报名可以提交作业的bug
- 排查xxx的bug




getVoteEnrollByGroupId

is_enroll_open

ENROLL_STATUS_ON

is_enrolled_by_group_student_id

# 20180524
- 多看多想逻辑很容易遗落，多看多想多问




curl -H 'Host: api.qinwei.umucdn.cn' -H 'Referer: http://qinwei.umucdn.cn/ajax/' -H 'umu-pm: iPhone6 Plus' -H 'Cookie: _lang=zh-cn' -H 'User-Agent: UMU-CN/3.4.61 (iPhone; iOS 11.3; Scale/3.00)' -H 'umu-t: oqjl0v3a2anlss12fjgcl1ll61' -H 'tk: f1ace91cc14840fdac6260ff9b2f02e81527146337' -H 'umu-up: CN' -H 'umu-tz: +8' -H 'umu-sc: ' -H 'id: u118356615' -H 'umu-sv: 11.3' -H 'umu-ul: zh-cn' -H 'umu-b: 3' -H 'Accept-Language: zh-Hans-CN;q=1, ja-CN;q=0.9, en-CN;q=0.8' -H 'umu-pi: 1242*2208' -H 'umu-v: 3.4.61' -H 'umu-sl: zh-Hans-CN' -H 'Accept: */*' -H 'umu-p: iOS' -H 'umu-as: AppStore' --data "skey=umu%F0%9F%94%91MVs9420_26b658a647%F0%9F%94%91umu" --compressed 'http://api.qinwei.umucdn.cn/common/getobjid'

Return
curl -H 'Host: api.qinwei.umucdn.cn' -H 'Referer: http://qinwei.umucdn.cn/ajax/' -H 'umu-pm: iPhone6 Plus' -H 'Cookie: _lang=zh-cn' -H 'User-Agent: UMU-CN/3.4.61 (iPhone; iOS 11.3; Scale/3.00)' -H 'umu-t: oqjl0v3a2anlss12fjgcl1ll61' -H 'tk: f1ace91cc14840fdac6260ff9b2f02e81527146337' -H 'umu-up: CN' -H 'umu-tz: +8' -H 'umu-sc: ' -H 'id: u118356615' -H 'umu-sv: 11.3' -H 'umu-ul: zh-cn' -H 'umu-b: 3' -H 'Accept-Language: zh-Hans-CN;q=1, ja-CN;q=0.9, en-CN;q=0.8' -H 'umu-pi: 1242*2208' -H 'umu-v: 3.4.61' -H 'umu-sl: zh-Hans-CN' -H 'Accept: */*' -H 'umu-p: iOS' -H 'umu-as: AppStore' --data "skey=umu%F0%9F%94%91MVs9420_26b658a647%F0%9F%94%91umu" --compressed 'http://api.qinwei.umucdn.cn/common/getobjid'


- 获取我的作业
curl -H 'Host: api.qinwei.umucdn.cn' -H 'Referer: http://qinwei.umucdn.cn/ajax/' -H 'umu-pm: iPhone6 Plus' -H 'Cookie: _lang=zh-cn' -H 'User-Agent: UMU-CN/3.4.61 (iPhone; iOS 11.3; Scale/3.00)' -H 'umu-t: oqjl0v3a2anlss12fjgcl1ll61' -H 'tk: f1ace91cc14840fdac6260ff9b2f02e81527146337' -H 'umu-up: CN' -H 'umu-tz: +8' -H 'umu-sc: ' -H 'id: u118356615' -H 'umu-sv: 11.3' -H 'umu-ul: zh-cn' -H 'umu-b: 3' -H 'Accept-Language: zh-Hans-CN;q=1, ja-CN;q=0.9, en-CN;q=0.8' -H 'umu-pi: 1242*2208' -H 'umu-v: 3.4.61' -H 'umu-sl: zh-Hans-CN' -H 'Accept: */*' -H 'umu-p: iOS' -H 'umu-as: AppStore' --data "parent_question_id=362982" --compressed 'http://api.qinwei.umucdn.cn/session/getmyhomework'



- 复制邀请码后的获取问答作业信息
curl -H 'Host: api.qinwei.umucdn.cn' -H 'Referer: http://qinwei.umucdn.cn/ajax/' -H 'umu-pm: iPhone6 Plus' -H 'Cookie: _lang=zh-cn' -H 'User-Agent: UMU-CN/3.4.61 (iPhone; iOS 11.3; Scale/3.00)' -H 'umu-t: oqjl0v3a2anlss12fjgcl1ll61' -H 'tk: f1ace91cc14840fdac6260ff9b2f02e81527146337' -H 'umu-up: CN' -H 'umu-tz: +8' -H 'umu-sc: ' -H 'id: u118356615' -H 'umu-sv: 11.3' -H 'umu-ul: zh-cn' -H 'umu-b: 3' -H 'Accept-Language: zh-Hans-CN;q=1, ja-CN;q=0.9, en-CN;q=0.8' -H 'umu-pi: 1242*2208' -H 'umu-v: 3.4.61' -H 'umu-sl: zh-Hans-CN' -H 'Accept: */*' -H 'umu-p: iOS' -H 'umu-as: AppStore' --compressed 'http://api.qinwei.umucdn.cn/session/getsessioninfo?session_id=188106'




- QRcode
curl -H 'Host: api.qinwei.umucdn.cn' -H 'Referer: http://qinwei.umucdn.cn/ajax/' -H 'umu-pm: iPhone6 Plus' -H 'Cookie: _lang=zh-cn' -H 'User-Agent: UMU-CN/3.4.61 (iPhone; iOS 11.3; Scale/3.00)' -H 'umu-t: oqjl0v3a2anlss12fjgcl1ll61' -H 'tk: f1ace91cc14840fdac6260ff9b2f02e81527146337' -H 'umu-up: CN' -H 'umu-tz: +8' -H 'umu-sc: ' -H 'id: u118356615' -H 'umu-sv: 11.3' -H 'umu-ul: zh-cn' -H 'umu-b: 3' -H 'Accept-Language: zh-Hans-CN;q=1, ja-CN;q=0.9, en-CN;q=0.8' -H 'umu-pi: 1242*2208' -H 'umu-v: 3.4.61' -H 'umu-sl: zh-Hans-CN' -H 'Accept: */*' -H 'umu-p: iOS' -H 'umu-as: AppStore' --data "qr_code=http%3A//m.qinwei.umucdn.cn/ssu_MVY90b3" --compressed 'http://api.qinwei.umucdn.cn/qr/fetchqrcode'



curl -H 'Host: api.qinwei.umucdn.cn' -H 'Referer: http://qinwei.umucdn.cn/ajax/' -H 'umu-pm: iPhone6 Plus' -H 'Cookie: _lang=zh-cn' -H 'User-Agent: UMU-CN/3.4.61 (iPhone; iOS 11.3; Scale/3.00)' -H 'umu-t: oqjl0v3a2anlss12fjgcl1ll61' -H 'tk: d6d313f95946f07ae5bcf661d3139c501527152903' -H 'umu-up: CN' -H 'umu-tz: +8' -H 'umu-sc: ' -H 'id: u118356615' -H 'umu-sv: 11.3' -H 'umu-ul: zh-cn' -H 'umu-b: 3' -H 'Accept-Language: zh-Hans-CN;q=1, ja-CN;q=0.9, en-CN;q=0.8' -H 'umu-pi: 1242*2208' -H 'umu-v: 3.4.61' -H 'umu-sl: zh-Hans-CN' -H 'Accept: */*' -H 'umu-p: iOS' -H 'umu-as: AppStore' --data "skey=umu%F0%9F%94%91KQS3090_26b658a647%F0%9F%94%91umu" --compressed 'http://api.qinwei.umucdn.cn/common/getobjid'


pd环境不同企业的账号A: z@qq.com qweqwe B:  X3@qq.com  123123  @秦伟 


//设置报名条件后，必须成功报名后查看作业

b/www/api/actions/Session/getMyHomework.php
a/www/api/actions/Session/saveSession.php

b/www/api/models/logic/qr/FetchQrCode.php



1、发布消息数据全部来自APP
2、展示的tab


